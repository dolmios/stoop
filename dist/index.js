import{createContext as mn}from"react";function P(t){return typeof t==="object"&&t!==null}function vt(t){return typeof t==="object"&&t!==null&&"__isStoopStyled"in t&&"__stoopClassName"in t&&t.__isStoopStyled===!0}function et(t){return P(t)&&!vt(t)}function b(t){return typeof t==="object"&&t!==null&&!Array.isArray(t)}function at(t){return function n(o){function r(i,e){let p={...i};for(let s in e){let c=e[s],S=i[s];if(b(c)&&b(S))p[s]=r(S,c);else if(c!==void 0)p[s]=c}return p}return r(t,o)}}import{useEffect as en,useMemo as ct,useRef as rn,forwardRef as sn,createElement as cn,useContext as Sn}from"react";import{createContext as Jt}from"react";var G=Object.freeze({}),ut=1e4,Ct=5000,Y=10,lt=Jt(null);var mt=new Map,F=new Map,N=new Map;function dt(t){return mt.has(t)}function gt(t){mt.set(t,t)}function Tt(){if(F.size>Ct){let t=F.keys().next().value;if(t)F.delete(t),N.delete(t)}}function q(t){let n=0;for(let o=0;o<t.length;o++){let r=t.charCodeAt(o);n=(n<<5)-n+r,n=n&n}return Math.abs(n).toString(36)}function Z(t){try{return q(JSON.stringify(t))}catch{return q(String(t))}}function Qt(t){return t.replace(/([A-Z])/g,"-$1").toLowerCase()}function I(t){return String(t).replace(/\\/g,"\\\\").replace(/"/g,"\\\"").replace(/'/g,"\\'").replace(/;/g,"\\;").replace(/\n/g,"\\A ").replace(/\r/g,"").replace(/\f/g,"\\C ")}function x(t){let n=t.replace(/[^a-zA-Z0-9\s\-_>+~:.#[\]&@()]/g,"");if(!n.trim()||/^[>+~:.#[\]&@()\s]+$/.test(n))return"";return n}function h(t){return t.replace(/[^a-zA-Z0-9-_]/g,"-").replace(/^[\d-]+/,"").replace(/^-+/,"")||"invalid"}function _t(t){return String(t).replace(/\\/g,"\\\\").replace(/"/g,"\\\"").replace(/'/g,"\\'").replace(/;/g,"\\;").replace(/\n/g,"\\A ").replace(/\r/g,"").replace(/\f/g,"\\C ").replace(/\{/g,"\\7B ").replace(/\}/g,"\\7D ")}function m(t){if(!t)return"";return t.replace(/[^a-zA-Z0-9-_]/g,"").replace(/^[\d-]+/,"").replace(/^-+/,"")||""}function yt(t){if(!t)return"";return t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function v(t){if(!t||typeof t!=="string")return"";let n=t.replace(/[^a-zA-Z0-9\s():,<>=-]/g,"");if(!n.trim()||!/[a-zA-Z]/.test(n))return"";return n}function Rt(t){if(!t||typeof t!=="string")return"";let n=t.trim().split(/\s+/),o=[];for(let r of n){if(!r)continue;let e=r.replace(/[^a-zA-Z0-9-_]/g,"").replace(/^\d+/,"");if(e&&/^[a-zA-Z-_]/.test(e))o.push(e)}return o.join(" ")}function U(t){if(!t||typeof t!=="string")return"";return Qt(t).replace(/[^a-zA-Z0-9-]/g,"").replace(/^-+|-+$/g,"").replace(/^\d+/,"")||""}function xt(t){if(!t||typeof t!=="string")return!1;if(t==="from"||t==="to")return!0;if(/^\d+(\.\d+)?%$/.test(t)){let o=parseFloat(t);return o>=0&&o<=100}return!1}var Ot=new WeakMap;function zt(t){let n=Ot.get(t);if(n)return n;let o=new Map;function r(i,e=[]){for(let p in i){let s=i[p],c=[...e,p];if(b(s))r(s,c);else o.set(p,c)}}return r(t),Ot.set(t,o),o}function Kt(t,n){let o=Object.keys(t),r=Object.keys(n);if(o.length!==r.length)return!1;for(let i of o)if(!(i in n))return!1;return!0}function J(t,n){if(t===n)return!0;if(!t||!n)return!1;if(!Kt(t,n))return!1;return JSON.stringify(t)===JSON.stringify(n)}function kt(t,n){return zt(t).get(n)||null}function tn(t,n){if(!t.startsWith("$"))return t;let o=t.slice(1);if(o.includes("."))return`var(${`--${o.split(".").map((s)=>h(s)).join("-")}`})`;if(n){let e=kt(n,o);if(e)return`var(${`--${e.map((c)=>h(c)).join("-")}`})`}return`var(${`--${h(o)}`})`}function W(t,n=""){let o=yt(n),r=o?`:root[data-stoop="${o}"]`:":root",i=[];function e(p,s=[]){for(let c in p){let S=p[c],f=[...s,c];if(b(S))e(S,f);else{let d=`--${f.map((T)=>h(T)).join("-")}`,M=typeof S==="string"||typeof S==="number"?_t(S):String(S);i.push(`  ${d}: ${M};`)}}}if(e(t),i.length===0)return"";return`${r} {
${i.join(`
`)}
}`}function D(t,n){if(!t||typeof t!=="object")return t;let o={};for(let r in t){let i=t[r];if(P(i))o[r]=D(i,n);else if(typeof i==="string"&&i.includes("$"))o[r]=i.replace(/(\$[a-zA-Z][a-zA-Z0-9]*(?:\.[a-zA-Z][a-zA-Z0-9]*)?)/g,(e)=>{return tn(e,n)});else o[r]=i}return o}var rt=new Map;function O(t,n){rt.set(t,n)}function V(t){return rt.has(t)}function Q(){return new Map(rt)}var j=[];function L(t){if(j.includes(t))return;if(j.length>=ut)j.shift();j.push(t)}function it(){return j.join(`
`)}function Mt(t){return j.includes(t)}var u=null,st=new Map,$t=new Map;function At(t=""){if(typeof document==="undefined")throw new Error("Cannot access document in SSR context");let n=m(t);if(u){if(u.parentNode)return u;if(u.textContent)try{return document.head.appendChild(u),u}catch{}u=null}u=document.createElement("style"),u.setAttribute("data-stoop",n||"stoop"),document.head.appendChild(u);let o=$t.get(n);if(o){let r=W(o,n);z(r,o,n)}return u}function z(t,n,o=""){if(!t)return;let r=m(o),i=`__theme_vars_${r}`,e=st.get(i)??null;if(J(e,n)){if(e!==n)st.set(i,n);return}if(st.set(i,n),typeof document==="undefined"){L(t);return}let p=At(r),s=p.textContent||"";if(V(i)){let c=r?`:root[data-stoop="${r}"]`:":root",S=new RegExp(`${c.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}\\s*\\{[^}]*\\}`,"g"),f=s.replace(S,"").trim();p.textContent=t+(f?`
`+f:""),O(i,t)}else p.textContent=t+(s?`
`+s:""),O(i,t)}function Pt(t,n=""){let o=m(n);if($t.set(o,t),typeof document!=="undefined"&&u?.parentNode){let r=W(t,o);z(r,t,o)}}function nn(t,n,o=""){if(typeof document==="undefined")return;let r=m(o);if(u&&u.parentNode){let i=u.textContent||"",e=t.replace(/\s+/g," ").trim();if(i.replace(/\s+/g," ").trim().includes(e)){if(!V(n))O(n,t);return}}try{let i=At(r),e=i.textContent||"",p=t.replace(/\s+/g," ").trim();if(e.replace(/\s+/g," ").trim().includes(p)){if(!V(n))O(n,t);return}let c=Q();if(!e&&c.size>0){let S=Array.from(c.entries()).filter(([f])=>!f.startsWith("__theme_vars_")&&f!==n).map(([,f])=>f).join(`
`);i.textContent=S+(S?`
`:"")+t}else if(e)i.textContent=e+`
`+t;else i.textContent=t;if(!V(n))O(n,t)}catch{if(!V(n))O(n,t)}if(!Mt(t))L(t)}function Et(t,n,o=""){if(V(n))return;if(O(n,t),dt(t))return;gt(t);let r=m(o);if(u&&u.parentNode)try{let i=u.textContent||"",e=t.replace(/\s+/g," ").trim();if(i.replace(/\s+/g," ").trim().includes(e))return}catch{}nn(t,n,r)}function bt(){return u}function A(t,n="",o){let r=o||t;if(typeof document==="undefined"){if(!V(r))O(r,t);L(t);return}Et(t,r,n)}function Ft(t,n,o=""){z(t,n,o)}function It(t,n=""){Pt(t,n)}function Ut(){if(typeof document!=="undefined"){let t=bt();if(t&&t.parentNode){let n=t.textContent||"";if(!n&&Q().size>0)return it();return n}}return it()}function K(t,n=""){if(typeof document==="undefined")return;let o=W(t,n);Ft(o,t,n)}function jt(t,n,o){let r=!1,i=[];for(let e in t){let p=n[e];if(p===void 0)continue;let s=t[e],c=p===!0?"true":p===!1?"false":String(p);if(s[c])i.push(s[c]),r=!0}return r?Object.assign({},o,...i):o}var k=Symbol.for("stoop.component");function pn(t){return{__isStoopStyled:!0,__stoopClassName:t,[k]:t,toString:()=>`__STOOP_COMPONENT_${t}`}}function fn(t){return typeof t==="object"&&t!==null&&"__isStoopStyled"in t&&t.__isStoopStyled===!0}function an(t,n){if(!n)return{elementProps:t,variantProps:{}};let o=new Set(Object.keys(n)),r={},i={};for(let e in t)if(o.has(e))r[e]=t[e];else i[e]=t[e];return{elementProps:i,variantProps:r}}function Bt(t,n="",o,r){return function i(e,p,s){let c=p||G,S=s;if(p&&"variants"in p&&typeof p.variants==="object"){S=p.variants;let{compoundVariants:T,variants:_,...y}=p;c=y}let f=H(c,t,n,o,r),a;if(typeof e!=="string"&&fn(e))a=e.__stoopClassName;let M=sn(function T(_,y){let{as:R,className:C,css:g,...Xt}=_,Gt=R||e,tt=g&&typeof g==="object"&&g!==null?g:G,{elementProps:Yt,variantProps:nt}=an(Xt,S),qt=Nt(),$=Sn(qt||lt)?.theme||t,ot=rn(null);en(()=>{let l=ot.current;if(J(l,$)){if(l!==$)ot.current=$;return}ot.current=$,K($,n)},[$,n]);let St=ct(()=>{if(!S)return"";let l=Object.entries(nt);if(l.length===0)return"";return l.sort(([E],[B])=>E.localeCompare(B)).map(([E,B])=>`${E}:${String(B)}`).join("|")},[S,...Object.values(nt)]),pt=ct(()=>{let l=c;if(S&&St)l=jt(S,nt,c);if(tt!==G)l=Object.assign({},l,tt);return l},[St,tt]),Zt=ct(()=>{let l=[];if(a)l.push(a);let E=H(pt,$,n,o,r);if(E)l.push(E);if(C){let B=typeof C==="string"?C:String(C),ft=Rt(B);if(ft)l.push(ft)}return l.length>0?l.join(" "):void 0},[pt,$,n,o,r,C,a]);return cn(Gt,{...Yt,className:Zt,ref:y})});return M.selector=pn(f),M}}function X(t,n){if(!n||!t||typeof t!=="object")return t;let o={},r=Object.keys(n);for(let i in t){let e=t[i];if(r.includes(i)&&n[i])try{let p=n[i](e);if(p&&typeof p==="object")Object.assign(o,p)}catch{o[i]=e}else if(P(e))o[i]=X(e,n);else o[i]=e}return o}function un(t,n){if(typeof t==="symbol"&&t===k)return!0;if(typeof n==="object"&&n!==null&&k in n)return!0;if(typeof t==="string"&&t.startsWith("__STOOP_COMPONENT_"))return!0;return!1}function Cn(t,n){if(typeof n==="object"&&n!==null&&"__stoopClassName"in n&&typeof n.__stoopClassName==="string")return n.__stoopClassName;if(typeof t==="string"&&t.startsWith("__STOOP_COMPONENT_"))return t.replace("__STOOP_COMPONENT_","");return""}function w(t,n="",o=0,r){if(!t||typeof t!=="object")return"";if(o>Y)return"";let i="",e="";for(let s in t){let c=t[s];if(un(s,c)){let S=Cn(s,c);if(!S)continue;let f=x(S);if(!f)continue;let a=`.${f}`,d=et(c)?w(c,a,o+1,r):"";e+=d;continue}if(et(c))if(r&&s in r){let S=v(r[s]);if(S){let f=w(c,n,o+1,r);e+=`${S} { ${f} }`}}else if(s.startsWith("@")){let S=x(s);if(S){let f=w(c,n,o+1,r);e+=`${S} { ${f} }`}}else if(s.includes("&")){let S=x(s);if(S){let f=S.replace(/&/g,n),a=w(c,f,o+1,r);e+=a}}else if(s.startsWith(":")){let S=x(s);if(S){let f=`${n}${S}`,a=w(c,f,o+1,r);e+=a}}else if(s.includes(" ")||s.includes(">")||s.includes("+")||s.includes("~")){let S=x(s);if(S){let f=`${n} ${S}`,a=w(c,f,o+1,r);e+=a}}else{let S=x(s);if(S){let f=n?`${n} ${S}`:S,a=w(c,f,o+1,r);e+=a}}else if(c!==void 0){let S=U(s);if(S&&(typeof c==="string"||typeof c==="number")){let f=I(c);i+=`${S}: ${f}; `}}}return(i?`${n} { ${i.trim()}}`:"")+e}function H(t,n,o="",r,i){let e=m(o),p=X(t,i),s=D(p,n),c=w(s,"",0,r),S=q(c),f=`${e}:${S}`,a=F.get(f);if(a){let T=N.get(f);if(T)return A(T,e,f),a;let _=w(s,`.${a}`,0,r);return N.set(f,_),A(_,e,f),a}let d=e?`${e}-${S}`:`css-${S}`,M=w(s,`.${d}`,0,r);return F.set(f,d),N.set(f,M),Tt(),A(M,e,f),d}var ht=null;function Wt(t){ht=t}function Nt(){return ht}function Dt(t,n="",o,r){return function i(e){return H(e,t,n,o,r)}}function Lt(t,n="",o,r){let i=new Set;return function e(p){if(typeof document==="undefined")return()=>{};let s=Z(p);if(i.has(s))return()=>{};i.add(s);function c(M,T=0){if(T>Y)return"";let _="";return Object.entries(M).forEach(([y,R])=>{if(P(R))if(o&&y in o){let C=v(o[y]);if(C){let g=c(R,T+1);_+=`${C} { ${g} }`}}else if(y.startsWith("@")){let C=x(y);if(C){let g=c(R,T+1);_+=`${C} { ${g} }`}}else{let C=x(y);if(C){let g=c(R,T+1);_+=`${C} { ${g} }`}}else if(R!==void 0){let C=U(y);if(C&&(typeof R==="string"||typeof R==="number")){let g=I(R);_+=`${C}: ${g}; `}}}),_}let S=m(n),f=X(p,r),a=D(f,t),d=c(a);return A(d,S,`__global_${s}`),()=>{i.delete(s)}}}function ln(t,n){let o=`@keyframes ${n} {`,r=Object.keys(t).sort((i,e)=>{let p=parseFloat(i.replace("%","")),s=parseFloat(e.replace("%",""));if(i==="from")return-1;if(e==="from")return 1;if(i==="to")return 1;if(e==="to")return-1;return p-s});for(let i of r){if(!xt(i))continue;let e=t[i];if(!e||typeof e!=="object")continue;o+=` ${i} {`;for(let p in e){let s=e[p];if(s!==void 0&&(typeof s==="string"||typeof s==="number")){let c=U(p);if(c){let S=I(s);o+=` ${c}: ${S};`}}}o+=" }"}return o+=" }",o}function Ht(t=""){let n=m(t),o=new Map;return function r(i){let e=Z(i),p=o.get(e);if(p)return p;let s=e.slice(0,8),c=n?`${n}-${s}`:`stoop-${s}`,S=ln(i,c),f=`__keyframes_${c}`;return A(S,n,f),o.set(e,c),c}}function dn(t){let{media:n,prefix:o="",theme:r,utils:i}=t,e=m(o),p=mn(null);Wt(p),It(r,e),K(r,e);let s=Dt(r,e,n,i),c=at(r),S=Lt(r,e,n,i),f=Ht(e),a=Bt(r,e,n,i),d=Object.freeze({...r});return{config:{...t,prefix:e},createTheme:c,css:s,getCssText:Ut,globalCss:S,keyframes:f,styled:a,theme:d,ThemeContext:p}}export{dn as createStoop};
