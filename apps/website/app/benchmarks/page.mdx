# Benchmarks

<Icon name="BarChart" size={24} style={{ display: "inline", verticalAlign: "middle", marginRight: "8px" }} /> Performance benchmarks comparing Stoop vs Stitches CSS-in-JS libraries.

## Methodology

### Test Environment
- Runtime: Bun (latest)
- React: v19.2.3
- Stitches: v1.2.8
- Stoop: Latest (from workspace)

### Measurement

Each benchmark measures CSS generation performance:
- CSS class name generation
- Theme token resolution
- CSS object compilation
- Styled component creation
- Variant combinations and CSS prop merging
- CSS text generation for SSR

**Limitations:** These benchmarks test CSS generation and component creation only. They do not test DOM rendering, browser layout/paint operations, or browser-based performance.

### Statistical Analysis

- Iteration counts: Automatically determined (50-10,000) based on variance
- Warmup: Continues until variance stabilizes (up to 50 runs)
- Statistics: Average, median, standard deviation, percentiles (P95, P99)
- Confidence intervals: 95% confidence intervals
- Outlier detection: IQR method
- Validation: Automatic checks for fair comparisons and result reliability

### Test Configuration

- Isolated instances: Fresh library instances per benchmark
- Identical themes: Both libraries use the same theme configuration
- Equivalent operations: Same complexity and operations tested
- API differences: Accounted for (Stitches `$primary` vs Stoop `$colors.primary`)

Benchmarks are reproducible. Run them using the [`stoop-benchmarks` package](https://github.com/dolmios/stoop/tree/main/packages/benchmarks).

## CSS Generation Benchmarks

| Test | Stoop (ms) | Stitches (ms) | Ratio |
|------|------------|---------------|-------|
| Initial Injection | ~0.010 | ~0.003 | Stitches 3-4x faster |
| Variant Updates | ~0.006 | ~0.006 | Negligible difference |
| CSS Prop Updates | ~0.005 | ~0.004 | Stitches 1.2x faster |
| Deep Tree (20 levels) | ~0.027 | ~0.050 | Stoop 1.7-1.9x faster |
| Wide Tree (100 siblings) | ~0.105 | ~0.220 | Stoop 2.1x faster |

Results are approximate averages. Actual results vary by system. Run `bun run benchmark` for full statistical analysis.

## React Component Benchmarks

| Test | Stoop (ms) | Stitches (ms) | Ratio |
|------|------------|---------------|-------|
| Simple Components | ~0.001 | ~0.001 | Negligible difference |
| Components with Variants | ~0.002 | ~0.002 | Negligible difference |
| Nested Component Trees | ~0.006 | ~0.005 | Negligible difference |

## SSR Benchmarks

| Test | Stoop (ms) | Stitches (ms) | Ratio |
|------|------------|---------------|-------|
| CSS Text Generation | ~0.012 | ~0.004 | Stitches 3.2x faster |
| Multiple Requests | ~0.012 | ~0.034 | Stoop 2.8x faster |
| Theme Switching | ~0.014 | ~0.032 | Stoop 2.3x faster |

## Running the Benchmarks

```bash
# From the repository root
bun run benchmark

# Or from the benchmarks package
cd packages/benchmarks
bun run benchmark
```

Benchmark suite: [`packages/benchmarks`](https://github.com/dolmios/stoop/tree/main/packages/benchmarks)
