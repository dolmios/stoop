# Benchmarks

<Icon name="Info" size={24} style={{ display: "inline", verticalAlign: "middle", marginRight: "8px" }} /> Performance benchmarks comparing Stoop vs Stitches CSS-in-JS libraries.

## Methodology

### Test Environment
- Runtime: Bun (latest)
- React: v19.2.3
- Stitches: v1.2.8
- Stoop: Latest (from workspace)

### Measurement

Each benchmark measures CSS generation performance:
- CSS class name generation
- Theme token resolution
- CSS object compilation
- Styled component creation
- Variant combinations and CSS prop merging
- CSS text generation for SSR

**Limitations:** These benchmarks test CSS generation and component creation only. They do not test DOM rendering, browser layout/paint operations, or browser-based performance.

**Note on Variability:** Microsecond-level measurements can vary significantly between runs due to JavaScript runtime behavior (JIT compilation, garbage collection), system load, and other factors. Results shown are approximate and represent typical performance characteristics. The benchmark suite includes statistical analysis with confidence intervals to help assess result reliability.

### Statistical Analysis

- Iteration counts: Determined (50-10,000) based on variance
- Warmup: Continues until variance stabilizes (up to 50 runs)
- Statistics: Average, median, standard deviation, percentiles (P95, P99)
- Confidence intervals: 95% confidence intervals
- Outlier detection: IQR method
- Validation: Automatic checks for fair comparisons and result reliability

### Test Configuration

- Isolated instances: Fresh library instances per benchmark
- Identical themes: Both libraries use the same theme configuration
- Equivalent operations: Same complexity and operations tested
- API differences: Accounted for (Stitches `$primary` vs Stoop `$colors.primary`)

Benchmarks are reproducible. Run them using the [`stoop-benchmarks` package](https://github.com/dolmios/stoop/tree/main/packages/benchmarks).

## CSS Generation Benchmarks

| Test | Stoop (ms) | Stitches (ms) | Ratio |
|------|------------|---------------|-------|
| Initial Injection | ~0.007-0.010 | ~0.002-0.003 | Stitches ~3-4x faster |
| Variant Updates | ~0.005-0.006 | ~0.005-0.006 | Negligible difference |
| CSS Prop Updates | ~0.004 | ~0.004 | Negligible difference |
| Deep Tree (20 levels) | ~0.029-0.031 | ~0.065-0.073 | Stoop ~2.2-2.4x faster |
| Wide Tree (100 siblings) | ~0.108-0.116 | ~0.223-0.253 | Stoop ~2.1-2.2x faster |

Results are approximate averages from multiple runs. Actual results vary significantly between runs due to microsecond-level measurement variability. Run `bun run benchmark` for full statistical analysis with confidence intervals.

## React Component Benchmarks

| Test | Stoop (ms) | Stitches (ms) | Ratio |
|------|------------|---------------|-------|
| Simple Components | ~0.001 | ~0.001 | Negligible difference |
| Components with Variants | ~0.002 | ~0.002 | Negligible difference |
| Nested Component Trees | ~0.006 | ~0.005 | Negligible difference |

## SSR Benchmarks

| Test | Stoop (ms) | Stitches (ms) | Ratio |
|------|------------|---------------|-------|
| CSS Text Generation | ~0.012-0.014 | ~0.004-0.005 | Stitches ~2.4-3.2x faster |
| Multiple Requests | ~0.013-0.015 | ~0.034-0.036 | Stoop ~2.4-2.7x faster |
| Theme Switching | ~0.011-0.012 | ~0.031-0.034 | Stoop ~2.6-2.9x faster |

## Running the Benchmarks

```bash
# From the repository root
bun run benchmark

# Or from the benchmarks package
cd packages/benchmarks
bun run benchmark
```

Benchmark suite: [`packages/benchmarks`](https://github.com/dolmios/stoop/tree/main/packages/benchmarks)
